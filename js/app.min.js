import{navigation,anime}from"./arrays.js";addEventListener("DOMContentLoaded",(()=>{const e=window.matchMedia("(max-width: 1200px)").matches;class t{constructor(e){this._class="object"==typeof e?e.class:e,this._videos=document.querySelectorAll(`.${this._class}`)}addVideoSource(){const e=window.matchMedia("(min-width: 768px)");for(let t=0;t<this._videos.length;t++){let s=this._videos[t];s.dataset.videoMob&&!e.matches?s.dataset.videoMobWebm?s.innerHTML=`<source src="${s.dataset.videoMobWebm}" type='video/webm; codecs="vp8, vorbis"'> <source src="${s.dataset.videoMob}"> `:s.innerHTML=`<source src="${s.dataset.videoMob}">`:s.dataset.video&&e.matches&&(s.dataset.videoWebm?s.innerHTML=`<source src="${s.dataset.videoWebm}" type='video/webm; codecs="vp8, vorbis"'> <source src="${s.dataset.video}"> `:s.innerHTML=`<source src="${s.dataset.video}">`)}}playOnScroll(){const e=new IntersectionObserver(((e,t)=>{for(let t=0;t<e.length;t++)e[t].isIntersecting?e[t].target.play():e[t].target.pause()}),{root:null,rootMargin:"0px 0px 0px 0px",threshold:.001}),t=[];for(let s=0;s<this._videos.length;s++)t.push(e.observe(this._videos[s]));return t}}new t("video-on-load").addVideoSource(),new t("video-on-load").playOnScroll();new class{constructor(e){this._class="object"==typeof e?e.class:e,this._currentElements=document.querySelectorAll(`.${this._class}`),this._options={root:null,rootMargin:`0px 0px ${e.marginBottom?e.marginBottom:"-20%"} 0px`,threshold:e.threshold?e.threshold:.01},this._observer=new IntersectionObserver(((t,s)=>{for(let s=0;s<t.length;s++)t[s].isIntersecting&&setTimeout((()=>{t[s].target.classList.remove("_hide"),t[s].target.classList.add("_visible")}),e.delay?e.delay:0)}),this._options)}setElementsVisibleOnScroll(){const e=[];for(let t=0;t<this._currentElements.length;t++)this._currentElements[t].classList.add("_hide"),e.push(this._observer.observe(this._currentElements[t]));return e}}("element-for-visible").setElementsVisibleOnScroll();class s{mainSlider(){new Swiper(".main-slider",{loop:!1,autoplay:!1,slidesPerView:"auto",effect:"fade",fadeEffect:{crossFade:!0},navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},pagination:{el:".swiper-pagination",clickable:!0}})}newProductSlider(){this.getText(),new Swiper(".new-products__slider",{loop:!0,autoplay:!0,spaceBetween:20,navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},pagination:{el:".swiper-pagination",clickable:!0},breakpoints:{1440:{slidesPerView:4},1200:{slidesPerView:3},745:{slidesPerView:2},360:{slidesPerView:1}}})}addEllipsis(e,t){const s=e.innerText;s.length>t&&(e.innerText=s.substring(0,t)+"...")}getText(){const e=document.querySelectorAll(".new-products__description");console.log(e),e.forEach((e=>{this.addEllipsis(e,76)}))}initSliders(){this.mainSlider(),this.newProductSlider()}}try{(new s).initSliders()}catch(e){console.log(`Sliders: ${e}`)}class i{constructor(e,t){this._backgroundShadow=this.createElement("background-shadow-js","div"),this.navigation=e,this.anime=t,this._arrowPath="./images/svg/arrow.svg",this._crossPath="./images/svg/cross.svg",this._body=document.body,this._mainSlider=document.querySelector(".main-slider"),this._burger=document.querySelector(".header__burger"),this._headerMenu}createElement(e,t){const s=document.createElement(t);return s.classList.add(e),s}hideMenu(e){this._headerCross.addEventListener("click",(()=>{e.classList.remove("_active"),e.style.animation="1s slideInRight forwards",e.classList.add("_hide"),setTimeout((()=>{this._backgroundShadow.classList.remove("_active")}),500)})),document.addEventListener("click",(t=>{e.contains(t.target)||this._burger.contains(t.target)||(e.classList.contains("_active")&&e.classList.add("_hide"),e.classList.remove("_active"),this._backgroundShadow.classList.remove("_active"))}))}showMenu(e){this._burger=document.querySelector(".header__burger"),this._burger.addEventListener("click",(()=>{e.classList.add("_active"),e.style.animation="1s slideInLeft forwards",e.classList.remove("_hide"),setTimeout((()=>{this._backgroundShadow.classList.add("_active")}),400)}))}createCross(){this._crossWrapper=this.createElement("header__cross-wrapper-js","div"),this._headerCross=this.createElement("header__cross-js","img"),this._headerCross.src=this._crossPath,this._crossWrapper.append(this._headerCross)}addAnime(e){this.animeItemWrapper=this.createElement("header__anime-wrapper-js","div"),this.anime.forEach(((e,t)=>{this.animeItem=this.createElement("header__anime-js","div"),this.animeItem.innerHTML=e,this.animeItemWrapper.append(this.animeItem)})),e.append(this.animeItemWrapper)}createMenu(){this._headerMenu=this.createElement("header__menu-js","div"),this._body.prepend(this._backgroundShadow),this.showMenu(this._headerMenu),this.createCross(),this.hideMenu(this._headerMenu),this._body.prepend(this._headerMenu),this._headerMenu.prepend(this._crossWrapper),this.navigation.forEach((e=>{if(this.HEADER_ITEM=this.createElement("header__item-js","div"),this.HEADER_ITEM.innerHTML=e,"аниме"==e||"инфо"==e||"новости"==e){const e=this.createElement("header__arrow-js","img");e.src=this._arrowPath,this.HEADER_ITEM.append(e)}"аниме"==e&&(this.addAnime(this.HEADER_ITEM),this.HEADER_ITEM.addEventListener("click",(()=>{this.animeItemWrapper.classList.contains("_active")?(this.animeItemWrapper.classList.remove("_active"),this.animeItemWrapper.style.maxHeight="0",this.animeItemWrapper.previousElementSibling.classList.remove("_active")):(this.animeItemWrapper.style.maxHeight=`${this.animeItemWrapper.scrollHeight}px`,this.animeItemWrapper.classList.add("_active"),this.animeItemWrapper.previousElementSibling.classList.add("_active"))}))),this._headerMenu.append(this.HEADER_ITEM)}))}}try{if(e){new i(navigation,anime).createMenu()}}catch(e){console.log(`MobileMeny: ${e}`)}class r extends i{constructor(e){super(e),this._trianglePath="./images/svg/triangle.svg"}addAnime(){const e=document.querySelector(".header__li"),t=this.createElement("header__anime-wrapper-desk-js","div"),s=this.createElement("header__triangle-js","img");s.src=this._trianglePath,e.append(s),anime.forEach((e=>{const s=this.createElement("header__anime-item-js","div");s.innerHTML=e,t.append(s)})),e.append(t),e.addEventListener("mouseover",(()=>{t.classList.add("_active"),s.classList.add("_active")})),e.addEventListener("mouseout",(()=>{t.classList.remove("_active"),s.classList.remove("_active")}))}showForm(){const e=document.querySelector(".header__phone-wrapper"),t=document.querySelector(".form-wrapper");this.createCross(),t.prepend(this._crossWrapper),this._body.prepend(this._backgroundShadow),this._crossWrapper.style.cssText="position: absolute; top: 20px; right: 0",e.addEventListener("click",(()=>{t.classList.add("_active"),setTimeout((()=>{this._backgroundShadow.classList.add("_active")}),400)}))}hideForm(){const e=document.querySelector(".form-wrapper");this._crossWrapper.addEventListener("click",(()=>{e.classList.remove("_active"),this._backgroundShadow.classList.remove("_active")}))}initForm(){this.showForm(),this.hideForm()}formFetch(){const e=document.querySelector(".form");e.onsubmit=async t=>{t.preventDefault();const s=new FormData(e);for(const[e,t]of s.entries())alert(`${e}: ${t}`)}}}try{const e=new r;e.addAnime(),e.initForm(),e.formFetch()}catch(e){console.log(`DesktopMenu: ${e}`)}const a=document.body;document.addEventListener("keydown",(e=>{e.ctrlKey&&"q"===e.key&&(bodyStyle=window.getComputedStyle(a),"auto"===bodyStyle.overflow?a.style.overflow="hidden":a.style.overflow="auto")}));try{document.querySelectorAll(".popular-collections__item").forEach((e=>{const t=document.createElement("img"),s=document.createElement("a");t.classList.add("popular-collections__arrow-js"),t.src="./images/svg/arrow-gray.svg",s.classList.add("popular-collections__arrow-wraper-js"),s.href="#",s.append(t),e.append(s)}))}catch(e){console.log(e)}}));